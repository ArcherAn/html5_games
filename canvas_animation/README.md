## **canvas中使用Animate动画** ##
**如图：**

![](http://i.imgur.com/s5R1C92.png)


**1、**本程序中主要是使用了**requestAnimationFrame()**方法让浏览器自行决定帧速率，同时为了考虑各种浏览器下对**animate()**函数的兼容性不同，综合解决问题，将代码封装在**window.requestNextAnimationFrame()**方法中去。

**2、**程序中同时还是用了一个简单的等式，根据当前帧距离上一帧的时间，计算出每秒钟播放的帧数（帧速率，简称 fps）

具体代码实现如 **animation_test.html** 和 **requestNextAnimationFrame.js**

## **canvas中实现视差动画** ##
**如图：**

![](http://i.imgur.com/Nht3KCm.png)

在本程序中，先计算出绘制四个图层时需要对坐标系进行平移的距离，然后保存绘图环境对象的状态，平移坐标原点，并将每个图层之中的物体绘制出来，最后再恢复绘图环境对象。这个“保存状态、平移坐标系、绘制物体、恢复状态”的流程可以免去计算物体坐标的麻烦，不管图层在当前这一帧滚动至何处，我们都只需将各个物体画在相同的坐标点上即可。由于坐标系在各帧之间发生了平移，所以画出来的图像看上去好像正在移动。

## **精灵原地跑步动画** ##
**如图：**

![](http://i.imgur.com/Ehy6maA.png)

![](http://i.imgur.com/8greViv.png)

**1、**精灵表绘制器会把精灵表中表示当前动画帧的那个单元格画出来。绘制器对象中还有一个数组索引，该数组中的元素对应于精灵表中给个单元格的信息。调用**advace()**方法将索引值加1。<br>
**2、**上图中显示出一张简单的精灵表，同时在页面下方使用精灵表中的图像来绘制动画。应用程序使用精灵表绘制器来将精灵表中的单元格绘制到屏幕上。<br>
**3、**改程序将动画的帧速率设置为每秒10帧（意思是一秒中切换10个画面，一帧就相当于1张图片），因为每秒60帧的情况下，9帧的动画会以极快的速度飞逝而过。程序中使用了9参数的**drawImage()**方法，将精灵表中需要显示的那块区域绘制到canvas中。

具体实现代码如 sprite_sheet _painter.html

## **精灵从左至右跑步动画** ##
**如图：**

![](http://i.imgur.com/Uprt1B8.png)

![](http://i.imgur.com/8A2IbED.png)

**1、**其实，只要实现精灵表绘制器中的**execute(sprite,context,time)**方法的对象，都可以叫作 “行为”。该方法一般会以某种方式来修改精灵的属性，比如说移动位置，或者修改其外观等。<br>
**2、**精灵中含有一个行为对象数组，它的update()方法会遍历该数组，使每个行为都得以执行一次。这样的话，我们就可以把行为封装成对象，在程序运行的时候将它添加到多个精灵之中。

具体实现代码如 sprite_ sheet_ painter_run.html

## **一个基于时间的动画行为** ##
**如图：**

![](http://i.imgur.com/PdKAHqB.png)

![](http://i.imgur.com/obUBe6d.png)

![](http://i.imgur.com/x3Fe1gW.png)

上述三幅图则展示了该应用主要的功能：即通过下方的向左向右按钮实现上面的小球每次向左或向右移动一定的像素（在规定的时间内），本程序设定的时间是200ms。即每一帧画面停留的时间为200ms,每次需要在规定的时间里移动110像素。

如果小球向左或向右移动超出其规定的位置(即超出了下面底板的位置，则重置小球的的位置，恢复原来的位置)。

程序中主要用到了一个封装的秒表对象 **stopwatch.js**  和一个封装的动画时间计时器对象 **animationTimer.js** 

程序中为了实现"基于时间的运动"效果，需要将小球的速度（单位是每秒移动的像素数）除以动画的帧速率（单位是每秒播放的帧数），这样就可以得到小球在当前一帧所移动的像素数了。

